"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const mongodb_1 = require("mongodb");
class MongoUtils {
    static toObjectId(id) {
        try {
            return new mongodb_1.ObjectID(id);
        }
        catch (err) {
            return undefined;
        }
    }
    static prepareUpdateObject(dto) {
        if (!dto || !Object.keys(dto).length) {
            return {};
        }
        const preparedObject = {};
        Object
            .keys(dto)
            .forEach(rootKey => {
            if (!!dto[rootKey] && typeof dto[rootKey] === 'object') {
                Object
                    .keys(dto[rootKey])
                    .forEach(childKey => {
                    preparedObject[`${rootKey}.${childKey}`] = dto[rootKey][childKey];
                });
            }
            else {
                preparedObject[rootKey] = dto[rootKey];
            }
        });
        return preparedObject;
    }
    static filterFindCondition(condition) {
        if (condition.id || condition._id) {
            condition._id = MongoUtils.toObjectId(condition.id || condition._id);
            delete condition.id;
        }
        return condition;
    }
    static fieldsStringFromArray(fields) {
        if (!fields || !fields.length) {
            return '';
        }
        return fields.filter(f => !!f && f.trim().length).map(f => f.trim()).join(' ');
    }
}
exports.MongoUtils = MongoUtils;
//# sourceMappingURL=mongo-utils.service.js.map